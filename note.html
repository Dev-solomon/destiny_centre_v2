<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community Chatroom</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%);
            height: 100vh;
            overflow: hidden;
        }

        /* Header Navigation */
        .header {
            background: rgba(0, 0, 0, 0.9);
            padding: 0.75rem 1.5rem;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo {
            color: white;
            font-size: 1.25rem;
            font-weight: bold;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 1.5rem;
        }

        .nav-menu a {
            color: #ccc;
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.3s;
        }

        .nav-menu a:hover,
        .nav-menu a.active {
            color: #4a90e2;
        }

        .hamburger {
            display: none;
            flex-direction: column;
            cursor: pointer;
        }

        .hamburger span {
            width: 20px;
            height: 2px;
            background: white;
            margin: 2px 0;
            transition: 0.3s;
        }

        /* Main Container */
        .main-container {
            display: flex;
            height: 100vh;
            padding-top: 60px;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: rgba(30, 30, 30, 0.95);
            border-right: 1px solid #333;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
        }

        .sidebar-header {
            padding: 1rem;
            border-bottom: 1px solid #333;
        }

        .online-count {
            color: #4a90e2;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        /* Users List */
        .users-list {
            flex: 1;
            overflow-y: auto;
            padding: 0.5rem;
        }

        .user-item {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            margin-bottom: 0.25rem;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .user-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #4a90e2;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 0.75rem;
            font-size: 0.9rem;
        }

        .user-name {
            color: #e0e0e0;
            font-size: 0.9rem;
        }

        /* Chat Area */
        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(20, 20, 20, 0.95);
        }

        .chat-header {
            padding: 1rem 1.5rem;
            background: rgba(30, 30, 30, 0.95);
            border-bottom: 1px solid #333;
        }

        .chat-title {
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.25rem;
        }

        .chat-title .highlight {
            color: #4a90e2;
        }

        .chat-subtitle {
            color: #aaa;
            font-size: 0.9rem;
        }

        /* Messages Container */
        .messages-container {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .message {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }

        .message.own {
            flex-direction: row-reverse;
        }

        .message-left {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
            flex-shrink: 0;
        }

        .message.own .message-left {
            align-items: center;
        }

        .message-sender {
            color: #4a90e2;
            font-weight: bold;
            font-size: 0.85rem;
            text-align: center;
            white-space: nowrap;
        }

        .message.own .message-sender {
            color: #28a745;
        }

        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #4a90e2;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            flex-shrink: 0;
        }

        .message.own .message-avatar {
            background: #28a745;
        }

        .message-content {
            max-width: 70%;
        }

        .message-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.25rem;
        }

        .message.own .message-info {
            flex-direction: row-reverse;
        }

        .message-time {
            color: #777;
            font-size: 0.75rem;
        }

        .message-text {
            background: rgba(255, 255, 255, 0.1);
            color: #e0e0e0;
            padding: 0.75rem 1rem;
            border-radius: 12px;
            word-wrap: break-word;
            line-height: 1.4;
            position: relative;
        }

        .message.own .message-text {
            background: rgba(74, 144, 226, 0.2);
        }

        .message-text-time {
            color: #aaa;
            font-size: 0.7rem;
            margin-top: 0.25rem;
            text-align: right;
        }

        .message.own .message-text-time {
            color: #ccc;
        }

        /* Date Badge */
        .date-badge {
            background: rgba(0, 0, 0, 0.4);
            color: #ccc;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            text-align: center;
            font-size: 0.8rem;
            margin: 1rem auto;
            width: fit-content;
            backdrop-filter: blur(5px);
        }

        /* Message Input */
        .refresh-button {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #444;
            color: #ccc;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            cursor: pointer;
            margin-bottom: 0.75rem;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .refresh-button:hover {
            background: rgba(74, 144, 226, 0.2);
            border-color: #4a90e2;
            color: #4a90e2;
        }

        .refresh-icon {
            transition: transform 0.5s ease;
        }

        .refresh-icon.rotating {
            animation: rotate 1s linear infinite;
        }

        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }

        .message-input-container {
            padding: 1rem;
            background: rgba(30, 30, 30, 0.95);
            border-top: 1px solid #333;
        }

        .message-input-wrapper {
            display: flex;
            gap: 0.5rem;
            align-items: flex-end;
        }

        .message-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #444;
            border-radius: 20px;
            padding: 0.75rem 1rem;
            color: white;
            resize: none;
            max-height: 120px;
            min-height: 44px;
            font-family: inherit;
        }

        .message-input:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .message-input:focus {
            outline: none;
            border-color: #4a90e2;
        }

        .message-input::placeholder {
            color: #999;
        }

        .send-button, .users-button {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: #4a90e2;
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }

        .send-button:hover, .users-button:hover {
            background: #357abd;
        }

        .send-button:disabled {
            background: #666;
            cursor: not-allowed;
        }

        .users-button {
            background: #28a745;
            display: none;
        }

        .users-button:hover {
            background: #1e7e34;
        }

        /* Email Popup */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .popup-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .popup {
            background: #2a2a2a;
            border-radius: 16px;
            padding: 2rem;
            max-width: 400px;
            width: 90%;
            text-align: center;
            transform: scale(0.7);
            transition: transform 0.3s ease;
        }

        .popup-overlay.active .popup {
            transform: scale(1);
        }

        .popup h3 {
            color: white;
            margin-bottom: 0.5rem;
            font-size: 1.25rem;
        }

        .popup p {
            color: #ccc;
            margin-bottom: 1.5rem;
            line-height: 1.5;
        }

        .popup input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #444;
            border-radius: 8px;
            background: #333;
            color: white;
            margin-bottom: 1rem;
            font-size: 1rem;
        }

        .popup input:focus {
            outline: none;
            border-color: #4a90e2;
        }

        .popup-buttons {
            display: flex;
            gap: 0.75rem;
        }

        .popup-button {
            flex: 1;
            padding: 0.75rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.2s;
        }

        .popup-button.primary {
            background: #4a90e2;
            color: white;
        }

        .popup-button.primary:hover {
            background: #357abd;
        }

        .popup-button.secondary {
            background: #666;
            color: white;
        }

        .popup-button.secondary:hover {
            background: #777;
        }

        /* Responsive Design */
        @media (max-width: 1024px) and (min-width: 769px) {
            .sidebar {
                width: 220px;
            }
            
            .nav-menu {
                gap: 1rem;
            }
            
            .nav-menu a {
                font-size: 0.8rem;
            }
        }

        @media (max-width: 768px) {
            .hamburger {
                display: flex;
            }
            
            .nav-menu {
                position: fixed;
                top: 60px;
                left: -100%;
                width: 100%;
                height: calc(100vh - 60px);
                background: rgba(0, 0, 0, 0.95);
                flex-direction: column;
                justify-content: flex-start;
                align-items: center;
                gap: 2rem;
                padding-top: 2rem;
                transition: left 0.3s;
            }
            
            .nav-menu.active {
                left: 0;
            }

            .sidebar {
                position: fixed;
                left: -280px;
                height: calc(100vh - 60px);
                z-index: 500;
            }
            
            .sidebar.active {
                transform: translateX(280px);
            }

            .chat-area {
                width: 100%;
            }
            
            .chat-title {
                font-size: 1.25rem;
            }
            
            .message-content {
                max-width: 85%;
            }

            .users-button {
                display: flex;
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: 0.5rem 1rem;
            }
            
            .main-container {
                padding-top: 50px;
            }
            
            .chat-header {
                padding: 0.75rem 1rem;
            }
            
            .chat-title {
                font-size: 1.1rem;
            }
            
            .messages-container {
                padding: 0.75rem;
                gap: 0.75rem;
            }
            
            .message-content {
                max-width: 90%;
            }
            
            .message-input-container {
                padding: 0.75rem;
            }
            
            .popup {
                padding: 1.5rem;
            }
        }

        /* Custom Scrollbar */
        .messages-container::-webkit-scrollbar,
        .users-list::-webkit-scrollbar {
            width: 6px;
        }

        .messages-container::-webkit-scrollbar-track,
        .users-list::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        .messages-container::-webkit-scrollbar-thumb,
        .users-list::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav-container">
            <div class="logo">â›ª</div>
            <ul class="nav-menu" id="navMenu">
                <li><a href="#home">Home</a></li>
                <li><a href="#about">About Us</a></li>
                <li><a href="#sermons">Sermons</a></li>
                <li><a href="#prayers">Prayers</a></li>
                <li><a href="#give">Give</a></li>
                <li><a href="#gallery">Gallery</a></li>
                <li><a href="#events">Events</a></li>
                <li><a href="#community" class="active">Community</a></li>
            </ul>
            <div class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </nav>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="online-count" id="onlineCount">45 members online</div>
            </div>
            <div class="users-list" id="usersList">
                <!-- Users will be populated by JavaScript -->
            </div>
        </aside>

        <!-- Chat Area -->
        <main class="chat-area">
            <div class="chat-header">
                <h1 class="chat-title">COMMUNITY <span class="highlight">CHATROOM</span></h1>
                <p class="chat-subtitle">Connect with fellow members, share encouragement, ask questions, and grow together in faith through real-time conversations.</p>
            </div>

            <div class="messages-container" id="messagesContainer">
                <!-- Messages will be populated by JavaScript -->
            </div>

            <div class="message-input-container">
                <button class="refresh-button" id="refreshButton">
                    <svg xmlns="http://www.w3.org/2000/svg" width="17" height="16" viewBox="0 0 17 16" fill="none"
                        class="refresh-icon" id="refreshIcon">
                        <path
                            d="M8.49967 2.13634C5.26128 2.13634 2.63604 4.76158 2.63604 7.99998C2.63604 11.2384 5.26128 13.8636 8.49967 13.8636C11.7381 13.8636 14.3633 11.2384 14.3633 7.99998C14.3633 7.64016 14.655 7.34846 15.0148 7.34846C15.3746 7.34846 15.6663 7.64016 15.6663 7.99998C15.6663 11.958 12.4577 15.1666 8.49967 15.1666C4.54163 15.1666 1.33301 11.958 1.33301 7.99998C1.33301 4.04194 4.54163 0.833313 8.49967 0.833313C9.9166 0.833313 11.2378 1.24488 12.3497 1.95437L13.1663 1.13776C13.2817 0.954836 13.4856 0.833313 13.7178 0.833313C14.0776 0.833313 14.3693 1.12501 14.3693 1.48483V3.5255C14.3693 4.3213 13.3805 4.68428 12.865 4.08507C11.7906 2.8879 10.2333 2.13634 8.49967 2.13634Z"
                            fill="#C1DEFD" />
                        <path
                            d="M8.49967 2.13634C5.26128 2.13634 2.63604 4.76158 2.63604 7.99998C2.63604 9.12016 2.95015 10.167 3.4951 11.0572L2.48394 11.8967C1.75587 10.775 1.33301 9.43686 1.33301 7.99998C1.33301 4.04194 4.54163 0.833313 8.49967 0.833313C9.9166 0.833313 11.2378 1.24488 12.3497 1.95437L13.1663 1.13776C13.2817 0.954836 13.4856 0.833313 13.7178 0.833313C14.0776 0.833313 14.3693 1.12501 14.3693 1.48483V3.5255C14.3693 4.3213 13.3805 4.68428 12.865 4.08507C11.7906 2.8879 10.2333 2.13634 8.49967 2.13634Z"
                            fill="#077BF8" />
                    </svg>
                    Click here to refresh chats
                </button>
                <div class="message-input-wrapper">
                    <textarea 
                        class="message-input" 
                        id="messageInput" 
                        placeholder="Write a message..."
                        rows="1"
                        disabled
                    ></textarea>
                    <button class="users-button" id="usersButton">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M16 4c0-1.11.89-2 2-2s2 .89 2 2-.89 2-2 2-2-.89-2-2zm4 18v-6c0-1.11-.89-2-2-2s-2 .89-2 2v6h4zM12.5 11.5c.83 0 1.5-.67 1.5-1.5s-.67-1.5-1.5-1.5S11 9.17 11 10s.67 1.5 1.5 1.5zm1.5 1h-3c-1.1 0-2 .9-2 2v7h7v-7c0-1.1-.9-2-2-2zM6.5 6C7.33 6 8 5.33 8 4.5S7.33 3 6.5 3 5 3.67 5 4.5 5.67 6 6.5 6zm1.5 1h-3C3.9 7 3 7.9 3 9v12h7V9c0-1.1-.9-2-2-2z"/>
                        </svg>
                    </button>
                    <button class="send-button" id="sendButton" disabled>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- Email Popup -->
    <div class="popup-overlay" id="popupOverlay">
        <div class="popup">
            <h3>Enter Email to Join the Conversation</h3>
            <p>Be part of our community discussion, share content, and connect with like-minded people for spiritual growth.</p>
            <input type="email" id="emailInput" placeholder="Email" required>
            <div class="popup-buttons">
                <button class="popup-button secondary" id="cancelButton">Cancel</button>
                <button class="popup-button primary" id="submitButton">Submit</button>
            </div>
        </div>
    </div>

    <script>
        // Sample data
        const users = [
            { name: "Martin", status: "online" },
            { name: "Sandra", status: "online" },
            { name: "David", status: "online" },
            { name: "Kimberly", status: "online" },
            { name: "Mary", status: "online" },
            { name: "Daniel", status: "online" },
            { name: "Patricia", status: "online" },
            { name: "Thomas", status: "online" },
            { name: "Linda", status: "online" },
            { name: "Christopher", status: "online" },
            { name: "Elizabeth", status: "online" },
            { name: "Joshua", status: "online" },
            { name: "Jessica", status: "online" },
            { name: "Andrew", status: "online" },
            { name: "Sarah", status: "online" },
            { name: "Ryan", status: "online" },
            { name: "Michelle", status: "online" },
            { name: "Kevin", status: "online" },
            { name: "Amanda", status: "online" },
            { name: "Steven", status: "online" }
        ];

        const sampleMessages = [
            { sender: "Thank you Chatroom!", time: "10:45 am", text: "", own: false, date: "yesterday" },
            { avatar: `/images/chat-image2.png`,sender: "Sandra Thomas", time: "11:23 am", text: "Good afternoon everyone having a beautiful Saturday morning", own: false, date: "today" },
            { sender: "You", time: "11:24 am", text: "Don't forget to pray for those who voted!", own: true, date: "today" },
            { sender: "Lella Gonzalez", time: "12:14 pm", text: "How are all of being blessed with another beautiful Saturday morning", own: false, date: "today" },
            { sender: "You", time: "12:15 pm", text: "Don't forget to pray before you sleep", own: true, date: "today" }
        ];

        // DOM Elements
        const hamburger = document.getElementById('hamburger');
        const navMenu = document.getElementById('navMenu');
        const sidebar = document.getElementById('sidebar');
        const usersList = document.getElementById('usersList');
        const messagesContainer = document.getElementById('messagesContainer');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const usersButton = document.getElementById('usersButton');
        const refreshButton = document.getElementById('refreshButton');
        const refreshIcon = document.getElementById('refreshIcon');
        const popupOverlay = document.getElementById('popupOverlay');
        const emailInput = document.getElementById('emailInput');
        const submitButton = document.getElementById('submitButton');
        const cancelButton = document.getElementById('cancelButton');

        let currentUser = null;
        let lastDateBadge = null;
        console.log(sampleMessages.image)
        // Initialize
        function init() {
            populateUsers();
            populateMessages();
            setupEventListeners();
            showEmailPopup();
        }

        // Populate users list
        function populateUsers() {
            usersList.innerHTML = '';
            users.forEach(user => {
                const userElement = document.createElement('div');
                userElement.className = 'user-item';
                userElement.innerHTML = `
                    <div class="user-avatar">${user.name.charAt(0)}</div>
                    <div class="user-name">${user.name}</div>
                `;
                usersList.appendChild(userElement);
            });
        }

        // Populate messages
        function populateMessages() {
            messagesContainer.innerHTML = '';
            lastDateBadge = null;
            sampleMessages.forEach(message => {
                if (message.text) {
                    addDateBadgeIfNeeded(message.date);
                    addMessageToChat(message.sender, message.text, message.time, message.own, message.avatar);
                }
            });
            scrollToBottom();
        }

        // Add date badge if needed
        function addDateBadgeIfNeeded(date) {
            if (lastDateBadge !== date) {
                const dateBadge = document.createElement('div');
                dateBadge.className = 'date-badge';
                dateBadge.textContent = date.charAt(0).toUpperCase() + date.slice(1);
                messagesContainer.appendChild(dateBadge);
                lastDateBadge = date;
            }
        }

        // Add message to chat
        function addMessageToChat(sender, text, time, isOwn = false, avatar = null) {
            const messageElement = document.createElement('div');
            messageElement.className = `message ${isOwn ? 'own' : ''}`;
            
             const displayName = isOwn ? "Me" : sender;
  const avatarMarkup = avatar
    ? `<img src="${avatar}" alt="${displayName}'s avatar" class="message-avatar" />`
    : `<div class="message-avatar">${sender.charAt(0).toUpperCase()}</div>`;

  messageElement.innerHTML = `
    <div class="message-left">
      <span class="message-sender">${displayName}</span>
       ${avatarMarkup}
    </div>
    <div class="message-content">
      <div class="message-text">
        ${text}
        <div class="message-text-time">${time}</div>
      </div>
    </div>
  `;

  messagesContainer.appendChild(messageElement);
  scrollToBottom();
}

        // Scroll to bottom
        function scrollToBottom() {
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Get current time
        function getCurrentTime() {
            const now = new Date();
            return now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }

        // Setup event listeners
        function setupEventListeners() {
            // Hamburger menu
            hamburger.addEventListener('click', () => {
                navMenu.classList.toggle('active');
            });

            // Users button (mobile only)
            usersButton.addEventListener('click', () => {
                sidebar.classList.toggle('active');
            });

            // Refresh button
            refreshButton.addEventListener('click', () => {
                // Start rotation animation
                refreshIcon.classList.add('rotating');
                refreshButton.textContent = '';
                refreshButton.appendChild(refreshIcon);
                refreshButton.appendChild(document.createTextNode(' Refreshing...'));
                
                setTimeout(() => {
                    populateMessages();
                    
                    // Stop rotation and reset text
                    refreshIcon.classList.remove('rotating');
                    refreshButton.textContent = '';
                    refreshButton.appendChild(refreshIcon);
                    refreshButton.appendChild(document.createTextNode(' Click here to refresh chats'));
                    
                    // Add a system message
                    addDateBadgeIfNeeded('today');
                    addMessageToChat('System', 'Chat refreshed successfully!', getCurrentTime(), false);
                }, 1000);
            });

            // Message input
            messageInput.addEventListener('input', () => {
                adjustTextareaHeight();
                sendButton.disabled = !messageInput.value.trim() || !currentUser;
            });

            messageInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    if (currentUser) {
                        sendMessage();
                    }
                }
            });

            // Send button
            sendButton.addEventListener('click', sendMessage);

            // Email popup
            submitButton.addEventListener('click', handleEmailSubmit);
            cancelButton.addEventListener('click', hideEmailPopup);
            
            popupOverlay.addEventListener('click', (e) => {
                if (e.target === popupOverlay) {
                    hideEmailPopup();
                }
            });

            // Close menu when clicking outside
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.hamburger') && !e.target.closest('.nav-menu')) {
                    navMenu.classList.remove('active');
                }
                
                if (!e.target.closest('.sidebar') && !e.target.closest('.users-button')) {
                    sidebar.classList.remove('active');
                }
            });
        }

        // Adjust textarea height
        function adjustTextareaHeight() {
            messageInput.style.height = 'auto';
            messageInput.style.height = Math.min(messageInput.scrollHeight, 120) + 'px';
        }

        // Send message
        function sendMessage() {
            const text = messageInput.value.trim();
            if (!text || !currentUser) return;

            addDateBadgeIfNeeded('today');
            addMessageToChat(currentUser, text, getCurrentTime(), true);
            messageInput.value = '';
            messageInput.style.height = 'auto';
            sendButton.disabled = true;

            // Simulate reply after a short delay
            setTimeout(() => {
                const randomUser = users[Math.floor(Math.random() * users.length)];
                const replies = [
                    "Amen! ðŸ™",
                    "Thank you for sharing!",
                    "God bless you!",
                    "Praying for you too!",
                    "Have a blessed day!",
                    "Thank you for the encouragement!"
                ];
                const randomReply = replies[Math.floor(Math.random() * replies.length)];
                addMessageToChat(randomUser.name, randomReply, getCurrentTime(), false);
            }, 1000 + Math.random() * 2000);
        }

        // Show email popup
        function showEmailPopup() {
            popupOverlay.classList.add('active');
        }

        // Hide email popup
        function hideEmailPopup() {
            popupOverlay.classList.remove('active');
        }

        // Handle email submit
        function handleEmailSubmit() {
            const email = emailInput.value.trim();
            if (!email) return;

            // Extract name from email
            currentUser = email.split('@')[0].charAt(0).toUpperCase() + email.split('@')[0].slice(1);
            
            // Enable message input
            messageInput.disabled = false;
            messageInput.placeholder = "Write a message...";
            
            hideEmailPopup();
            
            // Welcome message
            setTimeout(() => {
                addDateBadgeIfNeeded('today');
                addMessageToChat("System", `Welcome ${currentUser}! You've joined the community chatroom.`, getCurrentTime(), false);
            }, 500);
        }

        // Auto-resize textarea
        messageInput.addEventListener('input', adjustTextareaHeight);

        // Initialize the app
        init();

        // Simulate online users update
        setInterval(() => {
            const count = Math.floor(Math.random() * 10) + 40;
            document.getElementById('onlineCount').textContent = `${count} members online`;
        }, 30000);
    </script>
</body>
</html>